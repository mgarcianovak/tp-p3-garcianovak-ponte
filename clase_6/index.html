<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>

    </style>
</head>
<body>
    <form id="FormLista">
        <label>Formulario Lista</label><br>
        <label>Filtrar Por:</label>
        <select id="Filtro">
            <option value="1">Todos</option>
            <option value="2">Futbolistas</option>
            <option value="3">Profesionales</option>
        </select>
            <br>
        <label>Calcular edad Promedio:</label>
        <input id="Txt_Promedio" type="text">
        <button id="Btn_Calcular">Calcular</button><br>
        <label>Mostrar Columnas:</label><br>
        <input id="Chk_Id" type="checkbox" checked><label>ID</label>
        <input id="Chk_Nombre" type="checkbox" checked><label>Nombre</label>
        <input id="Chk_Apellido" type="checkbox" checked><label>Apellido</label>
        <input id="Chk_Edad" type="checkbox" checked><label>Edad</label>
        <input id="Chk_Equipo" type="checkbox" checked><label>Equipo</label>
        <input id="Chk_Posicion" type="checkbox" checked><label>Posicion</label><br>
        <input id="Chk_Goles" type="checkbox" checked><label>Cantidad Goles</label>
        <input id="Chk_Titulo" type="checkbox" checked><label>Titulo</label>
        <input id="Chk_Facultad" type="checkbox" checked><label>Facultad</label>
        <input id="Chk_Graduacion" type="checkbox" checked><label>Fecha Graduacion</label>
            <br>
        <table id="Table">
            <thead>
                <tr>
                    <th id="Th_Id" columna="ID">ID</th>
                    <th id="Th_Nombre" columna="Nombre">Nombre</th>
                    <th id="Th_Apellido" columna="Apellido">Apellido</th>
                    <th id="Th_Edad" columna="Edad">Edad</th>
                    <th id="Th_Titulo" columna="Titulo">Titulo</th>
                    <th id="Th_Facultad" columna="Facultad">Facultad</th>
                    <th id="Th_Graduacion" columna="Graduacion">AñoGrad</th>
                    <th id="Th_Equipo" columna="Equipo">Equipo</th>
                    <th id="Th_Posicion" columna="Posicion">Posicion</th>
                    <th id="Th_Goles" columna="Goles">CantGoles</th>
                </tr>
            </thead>
            <tbody id="T_body">           
            </tbody>
        </table>
        <br>
        <button id="btn_Agregar">Agregar</button>


    </form>
    <form id="FormTabla">

    </form>
</body>
    <script>
        var stringEnunciado = '[{"id":1, "nombre":"Marcelo", "apellido":"Luque", "edad":45, "titulo":"Ingeniero", "facultad":"UTN", "añoGraduacion":2002},{"id":2, "nombre":"Ramiro", "apellido":"Escobar", "edad":35, "titulo":"Medico", "facultad":"UBA", "añoGraduacion":20012},{"id":3, "nombre":"Facundo", "apellido":"Cairo", "edad":30, "titulo":"Abogado", "facultad":"UCA", "añoGraduacion":2017},{"id":4, "nombre":"Fernando", "apellido":"Nieto", "edad":18, "equipo":"Independiente", "posicion":"Delantero", "cantidadGoles":7},{"id":5, "nombre":"Manuel", "apellido":"Loza", "edad":20, "equipo":"Racing", "posicion":"Volante", "cantidadGoles":2},{"id":6, "nombre":"Nicolas", "apellido":"Serrano", "edad":23, "equipo":"Boca", "posicion":"Arquero", "cantidadGoles":0}]';

        class Persona {
            id;
            nombre;
            apellido;
            edad;
            constructor(p_id,p_nombre, p_apellido, p_edad){
                this.id = p_id;
                this.nombre = p_nombre;
                this.apellido = p_apellido;
                this.p_edad = p_edad;
            }
        }

        class Futbolista extends Persona{
            equipo;
            posicion;
            cantidadGoles;
            constructor(p_id,p_nombre, p_apellido, p_edad, equipo,posicion, cantidadGoles){
                super(p_id,p_nombre, p_apellido, p_edad,);
                this.equipo = equipo;
                this.posicion = posicion;
                this.cantidadGoles = cantidadGoles
            }
        }

        class Profesional extends Persona{
            titulo;
            facultad;
            anioGraduacion;
            constructor(p_id,p_nombre, p_apellido, p_edad,titulo, facultad, anioGraduacion){
                super(p_id,p_nombre, p_apellido, p_edad)
                this.titulo= titulo;
                this.facultad = facultad;
                this.anioGraduacion = anioGraduacion;
            }
        }


        class Modelo {
            Personas;
            constructor(){}
        }

        class Vista {
            FormLista;
            FormAbm;
            constructor(){
                this.FormLista = {
                    form: this.$("FormLista"),
                    filtro: this.$("Filtro"),
                    txtPromedio: this.$("Txt_Promedio"),
                    btnCalcular: this.$("Btn_Calcular"),
                    checkeboxes: {
                        chkId: this.$("Chk_Id"),
                        chkNombre: this.$("Chk_Nombre"),
                        chkApellido: this.$("Chk_Apellido"),
                        chkEdad: this.$("Chk_Edad"),
                        chkEquipo: this.$("Chk_Equipo"),
                        chkPosicion: this.$("Chk_Posicion"),
                        chkGoles: this.$("Chk_Goles"),
                        chkTitulo: this.$("Chk_Titulo"),
                        chkFacultad: this.$("Chk_Facultad"),
                        chkGraduacion: this.$("Chk_Graduacion")
                    },
                    tabla:{
                        tabla: this.$("Table"),
                        tbody: this.$("T_body"),
                        thId: this.$("Th_Id"),
                        thNombre: this.$("Th_Nombre"),
                        thApellido: this.$("Th_Apellido"),
                        thEdad: this.$("Th_Edad"),
                        thTitulo: this.$("Th_Titulo"),
                        thFacultad: this.$("Th_Facultad"),
                        thGraduacion: this.$("Th_Graduacion"),
                        thEquipo: this.$("Th_Equipo"),
                        thPosicion: this.$("Th_Posicion"),
                        thGoles: this.$("Th_Goles")
                    }, 
                    btnCalcular: this.$("btn_Agregar")
                }
            }

            $(id){
                return document.getElementById(id);
            }

            OcultarPorChecks(){
                let encabezados = this.FormLista.tabla.tabla.querySelectorAll("th");
                encabezados.forEach(e => {
                    this.Ocultar(e);
                });
                let celdas = this.FormLista.tabla.tabla.querySelectorAll("td");
                celdas.forEach(e => {
                    this.Ocultar(e);
                });
            }

            Ocultar(e){
                if(e.getAttribute("columna")=="ID"){
                        if (this.FormLista.checkeboxes.chkId.checked){
                            e.style.display='';
                        }else{
                            e.style.display='none';
                        }
                }
                if(e.getAttribute("columna")=="Nombre"){
                        if (this.FormLista.checkeboxes.chkNombre.checked){
                            e.style.display='';
                        }else{
                            e.style.display='none';
                        }
                }
                if(e.getAttribute("columna")=="Apellido"){
                        if (this.FormLista.checkeboxes.chkApellido.checked){
                            e.style.display='';
                        }else{
                            e.style.display='none';
                        }
                }
                if(e.getAttribute("columna")=="Edad"){
                        if (this.FormLista.checkeboxes.chkEdad.checked){
                            e.style.display='';
                        }else{
                            e.style.display='none';
                        }
                }
                if(e.getAttribute("columna")=="Titulo"){
                        if (this.FormLista.checkeboxes.chkTitulo.checked){
                            e.style.display='';
                        }else{
                            e.style.display='none';
                        }
                }
                if(e.getAttribute("columna")=="Facultad"){
                        if (this.FormLista.checkeboxes.chkFacultad.checked){
                            e.style.display='';
                        }else{
                            e.style.display='none';
                        }
                }
                if(e.getAttribute("columna")=="Graduacion"){
                        if (this.FormLista.checkeboxes.chkGraduacion.checked){
                            e.style.display='';
                        }else{
                            e.style.display='none';
                        }
                }
                if(e.getAttribute("columna")=="Equipo"){
                        if (this.FormLista.checkeboxes.chkEquipo.checked){
                            e.style.display='';
                        }else{
                            e.style.display='none';
                        }
                }
                if(e.getAttribute("columna")=="Posicion"){
                        if (this.FormLista.checkeboxes.chkPosicion.checked){
                            e.style.display='';
                        }else{
                            e.style.display='none';
                        }
                }
                if(e.getAttribute("columna")=="Goles"){
                        if (this.FormLista.checkeboxes.chkGoles.checked){
                            e.style.display='';
                        }else{
                            e.style.display='none';
                        }
                }
            }

            DibujarFilas(array){
                let fila
                this.Control.RegistrarDobleClickFila(fila);
            }

        }

        class Control {
            Vista;
            Modelo;
            constructor(p_vista, p_modelo, stringEnunciado){
                this.Modelo = p_modelo;
                this.Vista = p_vista;
                this.CargaInicial(stringEnunciado);
                this.RegistrarControladorChecks();
                this.Vista.Control = this;
            }

            CargaInicial(cadena) {
                let array = JSON.parse(cadena);
                this.Modelo.Personas = array.map(
                    (x)=>{
                            if(x.equipo){
                                return new Futbolista(x.id, x.nombre, x.apellido, x.edad, x.equipo, x.posicion, x.cantidadGoles);
                            }else{
                                return new Profesional(x.id, x.nombre, x.apellido, x.edad, x.titulo, x.facultad, x.añoGraduacion);                            
                            }
                        }
                );               
            }


            RegistrarControladorChecks(){
                this.Vista.FormLista.checkeboxes.chkId.addEventListener("change",(e)=>{this.Vista.OcultarPorChecks()});
                this.Vista.FormLista.checkeboxes.chkApellido.addEventListener("change",(e)=>{this.Vista.OcultarPorChecks()});
                this.Vista.FormLista.checkeboxes.chkNombre.addEventListener("change",(e)=>{this.Vista.OcultarPorChecks()});
                this.Vista.FormLista.checkeboxes.chkFacultad.addEventListener("change",(e)=>{this.Vista.OcultarPorChecks()});
                this.Vista.FormLista.checkeboxes.chkEdad.addEventListener("change",(e)=>{this.Vista.OcultarPorChecks()});
                this.Vista.FormLista.checkeboxes.chkGoles.addEventListener("change",(e)=>{this.Vista.OcultarPorChecks()});
                this.Vista.FormLista.checkeboxes.chkGraduacion.addEventListener("change",(e)=>{this.Vista.OcultarPorChecks()});
                this.Vista.FormLista.checkeboxes.chkTitulo.addEventListener("change",(e)=>{this.Vista.OcultarPorChecks()});
                this.Vista.FormLista.checkeboxes.chkEquipo.addEventListener("change",(e)=>{this.Vista.OcultarPorChecks()});
                this.Vista.FormLista.checkeboxes.chkPosicion.addEventListener("change",(e)=>{this.Vista.OcultarPorChecks()});
            }

            RegistrarDobleClickFila(fila){
                fila.addEventListener("dbclick",(e)=>{});
            }

        }

        var modelo = new Modelo();
        var vista = new Vista();
        var control = new Control(vista, modelo, stringEnunciado);



    </script>
</html>